{"version":3,"sources":["assets/Script/Hook.js"],"names":["cc","Class","Component","properties","HookStatus","HookSpeed","RotateSpeed","Line","type","EmitHookBtn","ScoreController","Miner","Main","start","scorer","getComponent","node","on","Node","EventType","TOUCH_END","EmitHookClick","anim","Animation","play","update","dt","HookControl","event","HookOut","HookIn","onCollisionEnter","other","self","group","parent","getItem","setPosition","v2","getChildByName","cleanItem","items","children","forEach","item","score","addScore","main","OreNumber","destroy","HookRotate","angle","Math","abs","onHookBack","height"],"mappings":"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","sourceRoot":"/","sourcesContent":["/*\n * @Author: czqczqzzzzzz(czq)\n * @Email: tenchenzhengqing@qq.com\n * @Date: 2023-06-01 22:30:36\n * @LastEditors: 陈正清MacPro\n * @LastEditTime: 2023-06-04 22:48:19\n * @FilePath: /goldminer-demo/assets/Script/Hook.js\n * @Description: 矿工钩子相关\n * \n * Copyright (c) by czqczqzzzzzz(czq), All Rights Reserved. \n */\n// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        HookStatus: 0,\n        HookSpeed: 1,\n        RotateSpeed: 0.5,\n        Line: {\n            default: null,\n            type: cc.Component,\n        },\n        EmitHookBtn: {\n            default: null,\n            type: cc.Component,\n        },\n        ScoreController: {\n            default: null,\n            type: cc.Component,\n        },\n        Miner: {\n            default: null,\n            type: cc.Component,\n        },\n        Main: {\n            default: null,\n            type: cc.Component,\n        }\n\n\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n    },\n\n\n\n\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start() {\n        this.scorer = this.ScoreController.getComponent('Score')\n        this.EmitHookBtn.node.on(cc.Node.EventType.TOUCH_END, this.EmitHookClick, this)\n        this.anim = this.Miner.getComponent(cc.Animation)\n        this.anim.play()\n    },\n\n\n    update(dt) {\n        this.HookControl()\n\n    },\n\n    EmitHookClick(event) {\n        this.HookOut()\n    },\n\n    HookIn() {\n        this.HookStatus = 2\n        this.anim.play('MinerPullLight')\n    },\n\n    HookOut() {\n        this.HookStatus = 1\n    },\n\n    onCollisionEnter(other, self) {\n        if (this.HookStatus == 2) { return }\n        if (other.node.group === 'wall') {\n            this.HookIn()\n        }\n        if (other.node.group === \"ore\") {\n            other.node.group = \"default\"\n            other.node.parent = this.getItem()\n            other.node.setPosition(cc.v2(0, 0))\n            this.HookIn()\n        }\n    },\n\n    getItem() {\n        return this.node.getChildByName(\"Item\")\n    },\n\n    // 收集上钩的物品\n    cleanItem() {\n        let items = this.getItem()\n        items.children.forEach(item => {\n            let score = item.getComponent('Ore').score\n            this.scorer.addScore(score)\n            let main = this.Main.getComponent('Main')\n            main.OreNumber--\n            item.destroy();\n        });\n\n    },\n\n    HookRotate() {\n        if (this.HookStatus == 0) {\n            if (this.Line.node.angle <= -70) {\n                this.RotateSpeed = Math.abs(this.RotateSpeed)\n            } else if (this.Line.node.angle >= 70) {\n                this.RotateSpeed = -Math.abs(this.RotateSpeed)\n            }\n\n            this.Line.node.angle += this.RotateSpeed\n        }\n    },\n\n    onHookBack() {\n\n    },\n\n    HookControl() {\n        //收回吊钩\n        if (this.HookStatus == 2 && this.Line.node.height <= 30) {\n            this.HookStatus = 0\n            this.cleanItem()\n            this.anim.play()\n        }\n        switch (this.HookStatus) {\n            case 0:\n                this.HookRotate()\n                break\n            case 1:\n                this.Line.node.height += this.HookSpeed\n                break\n            case 2:\n                this.Line.node.height -= this.HookSpeed\n                break\n        }\n\n    }\n\n});\n"]}